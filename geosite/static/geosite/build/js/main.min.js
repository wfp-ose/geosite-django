var geosite={};geosite.intend=function(e,t,n){n.$emit(e,t)},geosite.init_intents=function(e,t){e.on("click",".geosite-intent",function(e){e.preventDefault();var n=$(this);if(n.hasClass("geosite-toggle"))n.hasClass("geosite-off")?(n.removeClass("geosite-off"),geosite.intend(n.data("intent-names")[0],n.data("intent-data"),t)):(n.addClass("geosite-off"),geosite.intend(n.data("intent-names")[1],n.data("intent-data"),t));else if(n.hasClass("geosite-radio")){var o=n.parents(".geosite-radio-group:first").find(".geosite-radio").not(n);n.hasClass("geosite-on")||(n.addClass("geosite-on"),n.data("intent-class-on")&&(n.addClass(n.data("intent-class-on")),o.removeClass(n.data("intent-class-on"))),o.removeClass("geosite-on"),n.data("intent-class-off")&&(n.removeClass(n.data("intent-class-off")),o.addClass(n.data("intent-class-off"))),geosite.intend(n.data("intent-name"),n.data("intent-data"),t))}else geosite.intend(n.data("intent-name"),n.data("intent-data"),t)})},geosite.controller_base=function(e,t){this.intend=geosite.intend,geosite.init_intents($(t),e)},geosite.init_controller_base=function(e){e.controller("GeositeControllerBase",geosite.controller_base)},geosite.init_controller=function(e,t,n){var o=e.data("controllerName");e.data("controllerType");t.controller(o,n||geosite.controller_base)},geosite.init_controllers=function(e,t,n){for(var o=0;o<n.length;o++){var a=n[o];$(a.selector,e).each(function(){try{geosite.init_controller($(this),t,a.controller)}catch(e){console.log('Could not load Geosite Controller "'+a.selector+'"',e)}})}},geosite.init_state=function(e,t){var n=$.extend({},e),o=getHashValueAsFloat(["latitude","lat","y"])||e.lat||0,a=getHashValueAsFloat(["longitude","lon","long","lng","x"])||e.lon||0,i=getHashValueAsInteger(["zoom","z"])||e.z||3;return n.view=$.extend(n.view,{lat:o,lon:a,z:i}),$.each(n.filters,function(e,o){$.each(o,function(o,a){var i=t.filters[e][o].toLowerCase(),s=getHashValue(e+":"+o,i);void 0!=s&&""!=s&&(n.filters[e][o]=s)})}),n};var getHashValue=function(e,t){var n=void 0;e="string"==typeof e?[e.toLowerCase()]:$.map(e,function(e,t){return e.toLowerCase()});for(var o=location.hash.toLowerCase(),a=0;a<e.length;a++){var i=e[a],s=o.match(new RegExp(i+"=([^&]*)"));if(s&&(n=s[1],void 0!=n&&null!=n&&""!=n))break}return void 0!=t&&("integer"==t?n=void 0!=n&&null!=n&&""!=n?parseInt(n,10):void 0:"float"==t&&(n=void 0!=n&&null!=n&&""!=n?parseFloat(n):void 0)),n},hasHashValue=function(e){var t=getHashValue(e);return void 0!=t&&null!=t&&""!=t},getHashValueAsInteger=function(e){return getHashValue(e,"integer")},getHashValueAsFloat=function(e){return getHashValue(e,"float")},sortLayers=function(e,t){var n=$.isArray(e)?e:$.map(e,function(e){return e});return n=n.sort(function(e,t){return e.options.renderOrder-t.options.renderOrder}),t===!0&&n.reverse(),n},updateRenderOrder=function(e){for(var t=0;t<e.length;t++)e[t].bringToFront()},layersAsArray=function(e){return $.map(e,function(e,t){return{id:t,layer:e}})};